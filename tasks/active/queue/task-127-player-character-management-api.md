# Task ID: API-TASK-127
**–¢–∏–ø:** API Generation
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π
**–°—Ç–∞—Ç—É—Å:** queued
**–°–æ–∑–¥–∞–Ω–æ:** 2025-11-07 10:05
**–°–æ–∑–¥–∞—Ç–µ–ª—å:** AI Agent (API Task Creator)
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** API-TASK-126

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

**MVP –ë–õ–û–ö–ï–†!** –°–æ–∑–¥–∞—Ç—å API —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–≥—Ä–æ–∫–∞–º–∏ –∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏. –ë–ï–ó –≠–¢–û–ô –°–ò–°–¢–ï–ú–´ –ò–ì–†–ê –ù–ï –ú–û–ñ–ï–¢ –ó–ê–ü–£–°–¢–ò–¢–¨–°–Ø.

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:** –°–æ–∑–¥–∞—Ç—å OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è Player & Character Management System –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑ .BRAIN.

---

## üéØ –¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ–ª–Ω—ã–π REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –∏–≥—Ä–æ–∫–æ–≤ –∏ –∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏, –≤–∫–ª—é—á–∞—è —Å–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏, –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—é –≤–Ω–µ—à–Ω–æ—Å—Ç–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–æ—Ç–∞–º–∏.

**–ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ:**
- –ë–ï–ó –≠–¢–û–ì–û –ò–ì–†–ê –ù–ï –ó–ê–ü–£–°–¢–ò–¢–°–Ø (MVP –±–ª–æ–∫–µ—Ä)
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ–º –º–µ–∂–¥—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
- –•—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞

---

## üìö –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `.BRAIN`
**–ü—É—Ç—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É:** `.BRAIN/05-technical/backend/player-character-management.md`
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** v1.0.0
**API Readiness:** ready

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:**
- Player profiles (account-wide –¥–∞–Ω–Ω—ã–µ)
- Character creation/deletion
- Character switching (active character)
- Character slots (3 base + 2 premium = max 5)
- Character data (attributes, skills, inventory IDs, level, experience)
- Appearance customization (body, face, cyberware visibility)
- Naming validation (unique, 3-20 chars)
- Soft delete (30 days grace period)
- Character stats snapshot

---

## üìÅ –¶–µ–ª–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ API

**–¶–µ–ª–µ–≤—ã–µ —Ñ–∞–π–ª—ã:**
```
api/v1/players/
‚îú‚îÄ‚îÄ players.yaml       ‚Üê Player profiles (account-wide)
‚îî‚îÄ‚îÄ characters.yaml    ‚Üê Character CRUD operations
```

---

## ‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å (–ø–ª–∞–Ω)

### –§–∞–π–ª 1: players.yaml

**Endpoints:**

1. **GET /api/v1/players/me**
   - –ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π player profile
   - Response: player_id, account_id, premium_currency, settings

2. **PATCH /api/v1/players/me**
   - –û–±–Ω–æ–≤–∏—Ç—å player profile (settings)
   - Body: ui_settings?, audio_settings?, graphics_settings?, language?

3. **GET /api/v1/players/me/statistics**
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ (total_playtime, characters_count)

**Models:**
- PlayerProfile (id, account_id, premium_currency, settings, created_at)
- PlayerSettings (ui_settings, audio_settings, graphics_settings, language, timezone)
- PlayerStatistics (total_playtime, characters_count, achievement_points)

### –§–∞–π–ª 2: characters.yaml

**Endpoints:**

1. **GET /api/v1/characters**
   - –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏–≥—Ä–æ–∫–∞
   - Response: Character[] (id, name, class, level, is_active)

2. **POST /api/v1/characters**
   - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
   - Body: name, class_id, appearance, origin_id
   - Validation: max 5 characters, unique name
   - Response: Character (full data)

3. **GET /api/v1/characters/{character_id}**
   - –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ
   - Response: CharacterDetails (full data)

4. **DELETE /api/v1/characters/{character_id}**
   - –£–¥–∞–ª–∏—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (soft delete)
   - Action: deleted_at = now, deleted = true
   - Response: 204 No Content

5. **POST /api/v1/characters/{character_id}/restore**
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (–≤ —Ç–µ—á–µ–Ω–∏–µ 30 –¥–Ω–µ–π)
   - Response: Character

6. **POST /api/v1/characters/{character_id}/switch**
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (—Å–¥–µ–ª–∞—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–º)
   - Action: active_character_id = character_id
   - Response: 200 OK

7. **PATCH /api/v1/characters/{character_id}/appearance**
   - –û–±–Ω–æ–≤–∏—Ç—å –≤–Ω–µ—à–Ω–æ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
   - Body: appearance (body, face, cyberware)

8. **PATCH /api/v1/characters/{character_id}/name**
   - –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ (premium feature?)
   - Body: new_name
   - Validation: unique, 3-20 chars

**Models:**
- Character (id, player_id, name, class_id, origin_id, level, experience, appearance, created_at, last_played_at, deleted, is_active)
- CharacterDetails (extends Character + attributes, skills, current_location, faction_id)
- CharacterCreateRequest (name, class_id, appearance, origin_id)
- CharacterAppearance (body_type, skin_color, hair_style, face_options, cyberware_visibility)
- CharacterSlots (used_slots, max_slots, can_create_more)

---

## üîç –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏

1. ‚úÖ 2 —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–Ω—ã (players.yaml, characters.yaml)
2. ‚úÖ Character creation –≤–∫–ª—é—á–∞–µ—Ç –≤—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞ –∏ origin
3. ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏ (unique, 3-20 chars, no special chars)
4. ‚úÖ Soft delete —Å grace period 30 –¥–Ω–µ–π
5. ‚úÖ Character switching –æ–±–Ω–æ–≤–ª—è–µ—Ç active_character_id
6. ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: max 5 characters per player
7. ‚úÖ Appearance customization –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞
8. ‚úÖ –°–≤—è–∑—å —Å Authentication System (account_id)
9. ‚úÖ –°–≤—è–∑—å —Å Session Management (active character –ø—Ä–∏ login)
10. ‚úÖ Error responses —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### Character Slots

- Base: 3 slots (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
- Premium: +2 slots (–ø–æ–∫—É–ø–∫–∞ –∑–∞ premium currency)
- Maximum: 5 slots per account

### Character Lifecycle

```
CREATE ‚Üí ACTIVE ‚Üí PLAY ‚Üí SWITCH ‚Üí INACTIVE
                     ‚Üì
                  DELETE (soft) ‚Üí RESTORE (30 days) ‚Üí ACTIVE
                     ‚Üì
                  PERMANENT DELETE (after 30 days)
```

### Naming Rules

- Length: 3-20 characters
- Allowed: a-z, A-Z, 0-9, underscore, dash
- Must start with letter
- Unique globally (not just per player)
- No offensive words (blacklist check)

---

## üîó –°–≤—è–∑–∏

**Backend –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- Authentication System - account_id –¥–ª—è player profile
- Session Management - active_character_id –ø—Ä–∏ –≤—Ö–æ–¥–µ
- Progression System - class_id, attributes, skills
- Inventory System - character inventory
- Quest System - quest progress per character

**Frontend –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- Character Creation Screen
- Character Selection Screen
- Appearance Editor
- Character Management UI

---

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `.BRAIN/05-technical/backend/player-character-management.md`

